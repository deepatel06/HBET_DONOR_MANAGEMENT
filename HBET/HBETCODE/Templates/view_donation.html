<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Donation</title>
  <style>
    #dataTable td {
        text-align: center;
      }
          body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
          }
      
          .header {
            background-color: #0322d3;
            color: #fff;
            display: flex;
            justify-content: space-between;
            padding: 10px;
          }
      
          .menu {
            display: flex;
          }
      
          .menu a {
            color: #fff;
            text-decoration: none;
            margin: 0 10px;
          }
          .menu a:hover{
      background-color: #fd0404;
          }
      
          .profile-button {
            background-color: #fd0404;
            color: #fff;
            border: none;
            padding: 10px;
            border-radius: 3px;
            cursor: pointer;
          }

        </style>
        <link rel="stylesheet" type="text/css" href ="{% static 'datatables/1.10.22/css/jquery.dataTables.min.css' %}">
      </head>
      {%block content%}
  <div class="header">
    <div class="menu">
      <a href="/donorregistration">Donor Registration Form</a>
      <a href = "/donordetails">Donor Details</a>
      <a href="/add_donation">Add Donation</a>
      <a href="/view_donation">View Donation </a>
    </div>
    <a href="logout" style="color: #fff; background-color: #fd0404; height: 25px; width: 60px;">Logout </a>
  </div>

  <button id="exportBtn" style="margin-left : 10px; margin-top: 10px; margin-bottom: 10px" class="profile-button" onclick="exportToExcel()">Export to CSV</button>


   <div id="content">

  <table id="dataTable" class="display nowrap" style="width:100%">
        <thead>
            <tr>
                <th>Donation ID</th>
                <th>First name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Contact No</th>
                <th>Type Of Donation</th>
                <th>Amount</th>
                <th>Types of Payment</th>
                <th>Date Of Donation</th>
                <th>Pan No</th>
                <th>Remarks</th>
               
            </tr>
        </thead>
        <tbody>

            {% for data in rows %}
          <tr>
            <td>{{ data.donation_id }}</td>
            <td>{{ data.first_name }}</td>
            <td>{{ data.last_name }}</td>
            <td>{{ data.email }}</td>
            <td>{{ data.contact_no }}</td>
            <td>{{ data.type_of_donation }}</td>
            <td>{{ data.amount }}</td>
            <td>{{ data.type_of_payment }}</td>
            <td>{{ data.date_of_donation }}</td>
            <td>{{ data.pan_no }}</td>
            <td>{{ data.remarks }}</td>
          </tr>
          {% endfor %}



        </tbody>
    </table>


</div>

</center>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
 <script src="{% static 'datatables/1.10.22/js/jquery.dataTables.min.js' %}"></script>

  <script>

function downloadExcelFile(data, filename) {
  var blob = new Blob([data], { type: "application/vnd.ms-excel" });
  if (window.navigator && window.navigator.msSaveOrOpenBlob) {
    window.navigator.msSaveOrOpenBlob(blob, filename + ".xls");
  } else {
    var link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = filename + ".xls";
    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
}

function exportToExcel() {
  var table = document.getElementById("dataTable");
  var rows = Array.from(table.querySelectorAll("tbody tr"));

  var headers = Array.from(table.querySelectorAll("thead th")).map(function(th) {
    return th.textContent;
  });

  var data = [headers.join("\t")];

  rows.forEach(function(row) {
    var rowData = Array.from(row.children).map(function(cell) {
      return cell.textContent;
    });
    data.push(rowData.join("\t"));
  });

  var excelData = data.join("\r\n");
  var filename = "data";

  downloadExcelFile(excelData, filename);
}

function exportToCSV() {

   var table = document.getElementById("dataTable");
  var rows = table.querySelectorAll("tbody tr");
  var headerRow = Array.from(table.querySelectorAll("thead th")).map(function(th) {
    return th.textContent;
  });
  var csvContent = "data:text/csv;charset=utf-8,";

  // Build the header row
  var csvHeader = headerRow.join(",");
  csvContent += csvHeader + "\r\n";

  // Build the data rows
  rows.forEach(function(row) {
    var rowData = Array.from(row.children).map(function(cell) {
      return cell.textContent;
    });
    var csvRow = rowData.join(",");
    csvContent += csvRow ;
  });

  // Create a CSV file and trigger the download
  var encodedUri = encodeURI(csvContent);
  var link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", "data.csv");
  document.body.appendChild(link);
  link.click();
}



$(document).ready(function() {
  $('#dataTable').DataTable({

      scrollY: '500px',
      scrollX: '11px',
      paging: false,


    });
});

function redirect(){
window.location.href = "/editdonordetails";

}
  </script>
{% endblock %}
</body>
</html>

